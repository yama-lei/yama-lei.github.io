<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.19" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.67" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://github.com/yama-lei/yama-lei.github.io/posts/NJUCS/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/chapter8CPU.html"><meta property="og:site_name" content="Myblog"><meta property="og:title" content="chapter8 | CPU的设计"><meta property="og:description" content="CPU概述 CPU执行指令的过程： 根据pc取指令 异常时内部异常，中断时由于外部事件的出现导致CPU停止执行指令； 即内部异常，外部中断 计算机的五大组成部件 Memory I/O Datapath 数据通路 执行部件 Control Unit 控制部件 控制器：控制器对执行部件发出信号。 数据通路Datapath的基本结构 数据通路是由操作元件和存..."><meta property="og:type" content="article"><meta property="og:image" content="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250421114837747.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-05-24T11:50:20.000Z"><meta property="article:author" content="yama-lei"><meta property="article:published_time" content="2025-04-21T00:00:00.000Z"><meta property="article:modified_time" content="2025-05-24T11:50:20.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"chapter8 | CPU的设计","image":["https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250421114837747.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250427103915530.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250427104315618.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250427104604542.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250427110900124.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250427110804853.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250427112357474.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250427113923927.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428101709013.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428102812207.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428103132649.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428103320124.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428105102309.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428112505398.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428112702885.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428115548563.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509104343151.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509104713007.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509110118838.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509113020592.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509114300857.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509114755501.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509114657162.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509114650257.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509115710725.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509115926577.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250516105219861.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250516110435256.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250516105727514.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250516110036021.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250516111552870.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250516114408758.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250516115523660.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250523104536906.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250523105300126.png","https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250523114516205.png"],"datePublished":"2025-04-21T00:00:00.000Z","dateModified":"2025-05-24T11:50:20.000Z","author":[{"@type":"Person","name":"yama-lei"}]}</script><link rel="icon" href="/assets/icon/yama.svg"><title>chapter8 | CPU的设计 | Myblog</title><meta name="description" content="CPU概述 CPU执行指令的过程： 根据pc取指令 异常时内部异常，中断时由于外部事件的出现导致CPU停止执行指令； 即内部异常，外部中断 计算机的五大组成部件 Memory I/O Datapath 数据通路 执行部件 Control Unit 控制部件 控制器：控制器对执行部件发出信号。 数据通路Datapath的基本结构 数据通路是由操作元件和存...">
    <link rel="preload" href="/assets/style-HKakJfzV.css" as="style"><link rel="stylesheet" href="/assets/style-HKakJfzV.css">
    <link rel="modulepreload" href="/assets/app-DYMeyz6b.js"><link rel="modulepreload" href="/assets/chapter8CPU.html-C2cNciXb.js">
    <link rel="prefetch" href="/assets/index.html-VBIo52LM.js" as="script"><link rel="prefetch" href="/assets/intro.html-h9hY9aw7.js" as="script"><link rel="prefetch" href="/assets/underbuilding.html-CSZCpSVB.js" as="script"><link rel="prefetch" href="/assets/index.html-CUSSEBiC.js" as="script"><link rel="prefetch" href="/assets/love.html-DHnKzI6Q.js" as="script"><link rel="prefetch" href="/assets/index.html-CXz465bS.js" as="script"><link rel="prefetch" href="/assets/disable.html-BLE_bnP0.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-CXF31DEO.js" as="script"><link rel="prefetch" href="/assets/layout.html-C9k5Zw8W.js" as="script"><link rel="prefetch" href="/assets/markdown.html-CHsVo-t3.js" as="script"><link rel="prefetch" href="/assets/page.html-B9I9kFN9.js" as="script"><link rel="prefetch" href="/assets/index.html-CxwR952K.js" as="script"><link rel="prefetch" href="/assets/index.html-BUdCFd-c.js" as="script"><link rel="prefetch" href="/assets/git的使用.html-C9-MXLYP.js" as="script"><link rel="prefetch" href="/assets/实用网站.html-BUFupJHx.js" as="script"><link rel="prefetch" href="/assets/简单的命令行操作.html-CfNJ0BLt.js" as="script"><link rel="prefetch" href="/assets/index.html-BX-ystWa.js" as="script"><link rel="prefetch" href="/assets/2025_3_13.html-BJ_DI0QU.js" as="script"><link rel="prefetch" href="/assets/Letters.html-CiFrU-4O.js" as="script"><link rel="prefetch" href="/assets/NewYearEve.html-0y-i9Vch.js" as="script"><link rel="prefetch" href="/assets/index.html-DRUPY-rp.js" as="script"><link rel="prefetch" href="/assets/RedMountainZoo.html-BTIXEGnC.js" as="script"><link rel="prefetch" href="/assets/SocialPractice.html-Dan5YNMf.js" as="script"><link rel="prefetch" href="/assets/jhyz.html-aFjgjVd2.js" as="script"><link rel="prefetch" href="/assets/noTitle.html-D1ZnJAFG.js" as="script"><link rel="prefetch" href="/assets/index.html-QLzx9Ek-.js" as="script"><link rel="prefetch" href="/assets/Zhihu1.html-DFnBpZVm.js" as="script"><link rel="prefetch" href="/assets/Zhihu2.html-BwrDYD1y.js" as="script"><link rel="prefetch" href="/assets/Zhihu3.html-DpZsb2S9.js" as="script"><link rel="prefetch" href="/assets/beautifulSentence.html-Cbt-jtdu.js" as="script"><link rel="prefetch" href="/assets/konwledges.html-CC08vlxk.js" as="script"><link rel="prefetch" href="/assets/一位很优秀的老师说的话.html-BKP6_Bli.js" as="script"><link rel="prefetch" href="/assets/司法案件整理.html-BWW3U9jk.js" as="script"><link rel="prefetch" href="/assets/01背包.html-BUUxn4K3.js" as="script"><link rel="prefetch" href="/assets/class综合.html-BiAKBV2h.js" as="script"><link rel="prefetch" href="/assets/二分查找.html-D874fk_V.js" as="script"><link rel="prefetch" href="/assets/搜索.html-B6rBuor6.js" as="script"><link rel="prefetch" href="/assets/暴力枚举和递归.html-BGedIcmN.js" as="script"><link rel="prefetch" href="/assets/qt入门tutorial-第一节.html-fVFJGJPY.js" as="script"><link rel="prefetch" href="/assets/qt入门tutorial-第三节.html-BMLxzuhX.js" as="script"><link rel="prefetch" href="/assets/qt入门tutorial-第二节.html-CfA0B_08.js" as="script"><link rel="prefetch" href="/assets/qt入门tutorial-第四节.html-yc_cqhYL.js" as="script"><link rel="prefetch" href="/assets/List.html-Bbuqli0S.js" as="script"><link rel="prefetch" href="/assets/sicp笔记.html-6YAl3dWB.js" as="script"><link rel="prefetch" href="/assets/async function.html-_tKNOWbp.js" as="script"><link rel="prefetch" href="/assets/pinia.html-BYYdOvdY.js" as="script"><link rel="prefetch" href="/assets/vue3的响应式数据.html-B4hA5UJ6.js" as="script"><link rel="prefetch" href="/assets/元素的访问.html-BBCh0QUZ.js" as="script"><link rel="prefetch" href="/assets/图床配置.html-Du_hudXs.js" as="script"><link rel="prefetch" href="/assets/布局方式.html-BcvFMD2G.js" as="script"><link rel="prefetch" href="/assets/插槽.html-CLEw58Hl.js" as="script"><link rel="prefetch" href="/assets/组件的生命周期.html-DAg-eTre.js" as="script"><link rel="prefetch" href="/assets/组件通信.html-BEeRlAzf.js" as="script"><link rel="prefetch" href="/assets/自定义事件与监视.html-ChAkBLwz.js" as="script"><link rel="prefetch" href="/assets/路由.html-CQp8nU1E.js" as="script"><link rel="prefetch" href="/assets/Anaconda的学习.html-sER7IPGF.js" as="script"><link rel="prefetch" href="/assets/Pytorch学习.html-BQS2zDyn.js" as="script"><link rel="prefetch" href="/assets/VQA视觉问答系统.html-DmNvrmQ2.js" as="script"><link rel="prefetch" href="/assets/使用阿里云服务器训练模型.html-BPOBOHj1.js" as="script"><link rel="prefetch" href="/assets/学长分享.html-CrMHzKii.js" as="script"><link rel="prefetch" href="/assets/神经网络的基本概念.html-wfB0OOWS.js" as="script"><link rel="prefetch" href="/assets/链接实验室的服务器.html-iF0XcpXE.js" as="script"><link rel="prefetch" href="/assets/BeingMortalBookReading.html-BblGdimk.js" as="script"><link rel="prefetch" href="/assets/Drama-English-Version.html-BT0M9Q2j.js" as="script"><link rel="prefetch" href="/assets/周一戏剧.html-DpTRrthb.js" as="script"><link rel="prefetch" href="/assets/英语周一.html-DfpB08pb.js" as="script"><link rel="prefetch" href="/assets/英语周三.html-B_aEEo3t.js" as="script"><link rel="prefetch" href="/assets/FPGA设计和硬件描述语言.html-Dlc0QFrt.js" as="script"><link rel="prefetch" href="/assets/chapter6运算方法和运算部件.html-WOTdY3wf.js" as="script"><link rel="prefetch" href="/assets/chapter7指令计算集.html-BtS6oFZB.js" as="script"><link rel="prefetch" href="/assets/logisim实验.html-CJ-I64_A.js" as="script"><link rel="prefetch" href="/assets/专题：各种寄存器的相互转换.html-wnt4Pjsz.js" as="script"><link rel="prefetch" href="/assets/二进制表示.html-DqqortVs.js" as="script"><link rel="prefetch" href="/assets/作业：第四章.html-CBoJ8K1i.js" as="script"><link rel="prefetch" href="/assets/数字逻辑基础.html-Dm49_MN6.js" as="script"><link rel="prefetch" href="/assets/时序逻辑电路.html-C-y2uQIU.js" as="script"><link rel="prefetch" href="/assets/组合逻辑电路.html-DQymlPFO.js" as="script"><link rel="prefetch" href="/assets/ppt-midterm-例题.html-C-fF0Fw8.js" as="script"><link rel="prefetch" href="/assets/普通物理学.html-i952grDU.js" as="script"><link rel="prefetch" href="/assets/DM.html-DugUZtRp.js" as="script"><link rel="prefetch" href="/assets/FileOperation.html-XlO6tVf6.js" as="script"><link rel="prefetch" href="/assets/STL容器.html-CFIOV3Os.js" as="script"><link rel="prefetch" href="/assets/class.html-CD2u1g22.js" as="script"><link rel="prefetch" href="/assets/stl算法.html-BcKvRUid.js" as="script"><link rel="prefetch" href="/assets/string.html-Y2xNNgf0.js" as="script"><link rel="prefetch" href="/assets/内存安全程序设计.html-DZt-w8n_.js" as="script"><link rel="prefetch" href="/assets/排序.html-W_UXPPR7.js" as="script"><link rel="prefetch" href="/assets/程序设计基础期末复习.html-Bcz7Di4U.js" as="script"><link rel="prefetch" href="/assets/课程安排.html-S0gos70I.js" as="script"><link rel="prefetch" href="/assets/课程笔记.html-C5QgVLGI.js" as="script"><link rel="prefetch" href="/assets/组会汇报week1.html-BnqdSVtD.js" as="script"><link rel="prefetch" href="/assets/组会汇报week2.html-6sVrGzA8.js" as="script"><link rel="prefetch" href="/assets/组会汇报week3.html-CB93GR_z.js" as="script"><link rel="prefetch" href="/assets/组会汇报week4.html-DI-DqRLE.js" as="script"><link rel="prefetch" href="/assets/组会汇报week5.html-BjQUQIQU.js" as="script"><link rel="prefetch" href="/assets/组会汇报week6.html-CbsVL6gz.js" as="script"><link rel="prefetch" href="/assets/1.html-uE6HmQj3.js" as="script"><link rel="prefetch" href="/assets/404.html-BWPRputx.js" as="script"><link rel="prefetch" href="/assets/index.html-oX5APlNg.js" as="script"><link rel="prefetch" href="/assets/index.html-C_sL-2Xx.js" as="script"><link rel="prefetch" href="/assets/index.html-H1nbH3yS.js" as="script"><link rel="prefetch" href="/assets/index.html-DAliwL-K.js" as="script"><link rel="prefetch" href="/assets/index.html-DzddAxfT.js" as="script"><link rel="prefetch" href="/assets/index.html-DfQ4r-uf.js" as="script"><link rel="prefetch" href="/assets/index.html-C2OnkWYO.js" as="script"><link rel="prefetch" href="/assets/index.html-fmi8yFIb.js" as="script"><link rel="prefetch" href="/assets/index.html-BYomW_kF.js" as="script"><link rel="prefetch" href="/assets/index.html-Bprus9Qa.js" as="script"><link rel="prefetch" href="/assets/index.html-B9TNmpBN.js" as="script"><link rel="prefetch" href="/assets/index.html-DY5YH11H.js" as="script"><link rel="prefetch" href="/assets/index.html-DMJjbgVg.js" as="script"><link rel="prefetch" href="/assets/index.html-B2SuWkgF.js" as="script"><link rel="prefetch" href="/assets/index.html-BmA4at3p.js" as="script"><link rel="prefetch" href="/assets/index.html-DE9fabqn.js" as="script"><link rel="prefetch" href="/assets/index.html-CN_GgqfK.js" as="script"><link rel="prefetch" href="/assets/index.html-CoRtcRnK.js" as="script"><link rel="prefetch" href="/assets/index.html-CXhqhNaC.js" as="script"><link rel="prefetch" href="/assets/index.html-C11ADv7a.js" as="script"><link rel="prefetch" href="/assets/index.html-BMZ2sbnH.js" as="script"><link rel="prefetch" href="/assets/auto-Q-Ce4MY6.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-B3O8JSaZ.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-DotuGrRK.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-BAQT6v9A.js" as="script"><link rel="prefetch" href="/assets/math.esm-Cgto3ffo.js" as="script"><link rel="prefetch" href="/assets/search.esm-BPaPUgSs.js" as="script"><link rel="prefetch" href="/assets/notes.esm-DugvsDbc.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-BPsgJ1Hi.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-CMg0yb1C.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-BqiCZtWi.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="带我回家"><img class="vp-nav-logo" src="/assets/icon/yamasun.svg" alt><!----><span class="vp-site-name hide-in-pad">Myblog</span></a><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="博客主页"><!--[--><i class="vp-icon fas fa-home" style=""></i><!--]-->博客主页<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/thinking/" aria-label="人生感悟"><!--[--><img class="vp-icon" src="/assets/icon/thinking.svg" alt aria-hidden no-view style=""><!--]-->人生感悟<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="博文"><!--[--><i class="vp-icon fas fa-pen-to-square" style=""></i>博文<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/python%E5%AD%A6%E4%B9%A0/" aria-label="python"><!---->python<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" aria-label="前端开发"><!---->前端开发<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/%E7%A7%91%E7%A0%94%E5%90%AF%E8%92%99/" aria-label="科研启蒙"><!---->科研启蒙<!----></a></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle"><a class="route-link route-link-active auto-link" href="/posts/NJUCS/" aria-label="NJUCS"><!---->NJUCS<!----></a></h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/NJUCS/%E9%AB%98%E7%BA%A7%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/" aria-label="高级程序设计"><!---->高级程序设计<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link route-link-active auto-link" href="/posts/NJUCS/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/" aria-label="数字逻辑与计算机组成"><!---->数字逻辑与计算机组成<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/posts/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" aria-label="前端开发"><!--[--><i class="vp-icon fas fa-pen-to-square" style=""></i><!--]-->前端开发<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/posts/NJUCS/" aria-label="NJUCS南大计算机笔记"><!--[--><img class="vp-icon" src="/assets/icon/nju.svg" alt aria-hidden no-view style=""><!--]-->NJUCS南大计算机笔记<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/posts/%E7%A7%91%E7%A0%94%E5%90%AF%E8%92%99/" aria-label="科研启蒙"><!--[--><img class="vp-icon" src="/assets/icon/nju.svg" alt aria-hidden no-view style=""><!--]-->科研启蒙<!----></a></div></nav><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/yama-lei/yama-lei.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/" aria-label="博客主页"><!--[--><i class="vp-icon fas fa-home" style=""></i><!--]-->博客主页<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><i class="vp-icon fas fa-book" style=""></i><span class="vp-sidebar-title">文章</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">C++开发</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/git%E7%9A%84%E4%BD%BF%E7%94%A8.html" aria-label="github入门--the missing class for cs learner"><!---->github入门--the missing class for cs learner<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">NJUCS</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Others</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">数字逻辑与计算机组成</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/posts/NJUCS/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/chapter6%E8%BF%90%E7%AE%97%E6%96%B9%E6%B3%95%E5%92%8C%E8%BF%90%E7%AE%97%E9%83%A8%E4%BB%B6.html" aria-label="chapter6 | 运算方法和运算部件"><!---->chapter6 | 运算方法和运算部件<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/NJUCS/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/chapter7%E6%8C%87%E4%BB%A4%E8%AE%A1%E7%AE%97%E9%9B%86.html" aria-label="Chapter7 | 指令系统"><!---->Chapter7 | 指令系统<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/posts/NJUCS/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/chapter8CPU.html" aria-label="chapter8 | CPU的设计"><!---->chapter8 | CPU的设计<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/NJUCS/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/FPGA%E8%AE%BE%E8%AE%A1%E5%92%8C%E7%A1%AC%E4%BB%B6%E6%8F%8F%E8%BF%B0%E8%AF%AD%E8%A8%80.html" aria-label="FPGA设计和硬件描述语言"><!---->FPGA设计和硬件描述语言<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/NJUCS/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/%E4%BD%9C%E4%B8%9A%EF%BC%9A%E7%AC%AC%E5%9B%9B%E7%AB%A0.html" aria-label="Homework4"><!---->Homework4<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/NJUCS/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/%E4%B8%93%E9%A2%98%EF%BC%9A%E5%90%84%E7%A7%8D%E5%AF%84%E5%AD%98%E5%99%A8%E7%9A%84%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2.html" aria-label="专题：D，T寄存器和D锁存器之间的转换"><!---->专题：D，T寄存器和D锁存器之间的转换<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/NJUCS/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/%E4%BA%8C%E8%BF%9B%E5%88%B6%E8%A1%A8%E7%A4%BA.html" aria-label="二进制表示"><!---->二进制表示<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/NJUCS/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/logisim%E5%AE%9E%E9%AA%8C.html" aria-label="数字逻辑与计算机组成实验"><!---->数字逻辑与计算机组成实验<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/NJUCS/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/%E6%97%B6%E5%BA%8F%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF.html" aria-label="时序逻辑电路"><!---->时序逻辑电路<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/NJUCS/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E5%9F%BA%E7%A1%80.html" aria-label="第二章 | 数字逻辑基础"><!---->第二章 | 数字逻辑基础<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/NJUCS/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/%E7%BB%84%E5%90%88%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF.html" aria-label="组合逻辑电路"><!---->组合逻辑电路<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">普通物理学（上）</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">离散数学</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">高级程序设计</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">OJ难题积累与学习</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Python学习</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">前端开发</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/%E5%AE%9E%E7%94%A8%E7%BD%91%E7%AB%99.html" aria-label="实用网站"><!---->实用网站<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">科研启蒙</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/%E7%AE%80%E5%8D%95%E7%9A%84%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%93%8D%E4%BD%9C.html" aria-label="简单的命令行操作"><!---->简单的命令行操作<!----></a></li></ul></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/intro.html" aria-label="个人简介"><!--[--><img class="vp-icon" src="/assets/icon/intro.svg" alt aria-hidden no-view style=""><!--]-->个人简介<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/game/" aria-label="game"><!--[--><img class="vp-icon" src="/assets/icon/game.svg" alt aria-hidden no-view style=""><!--]-->game<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->chapter8 | CPU的设计</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">yama-lei</span></span><span property="author" content="yama-lei"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025年4月21日</span><meta property="datePublished" content="2025-04-21T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 26 分钟</span><meta property="timeRequired" content="PT26M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><!--[--><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cpu概述">CPU概述</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#计算机的五大组成部件">计算机的五大组成部件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#计算机性能">计算机性能</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#单周期的cpu设计">单周期的CPU设计</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#单流水线cpu的设计">单流水线CPU的设计</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#控制器的设计">控制器的设计</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#多周期cpu设计">多周期CPU设计</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#指令执行的过程">指令执行的过程</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#pla控制器的设计">PLA控制器的设计</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#微程序控制器设计">微程序控制器设计</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#异常处理机制">异常处理机制</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#多周期和时钟周期的cpu比较">多周期和时钟周期的CPU比较</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#核心思想">核心思想</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#与其他cpu比较">与其他CPU比较</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#指令执行分析">指令执行分析</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#r-type">R-Type</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#store">Store</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#i-type">I-Type</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#beq">Beq</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#j-type">J-Type</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#数据通路设计">数据通路设计</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#iunit设计">IUnit设计</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#reg-dec">Reg/Dec</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#exec-unit的设计">Exec Unit的设计</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#m段">M段</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#wb写回段">WB写回段</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#流水线中的control-signals">流水线中的Control Signals</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#流水线举例">流水线举例</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#单周期vs流水线计算机的性能比较">单周期vs流水线计算机的性能比较</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#流水线的冒险和处理">流水线的冒险和处理</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#结构冒险的解决">结构冒险的解决</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#数据冒险的冒险">数据冒险的冒险</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--]--><!----></aside></div><!----><div class="theme-hope-content" vp-content><h2 id="cpu概述" tabindex="-1"><a class="header-anchor" href="#cpu概述"><span>CPU概述</span></a></h2><p><strong>CPU执行指令的过程</strong>：</p><ol><li>根据pc取指令</li></ol><p>异常时内部异常，中断时由于外部事件的出现导致CPU停止执行指令； 即<code>内部异常，外部中断</code></p><hr><h3 id="计算机的五大组成部件" tabindex="-1"><a class="header-anchor" href="#计算机的五大组成部件"><span><strong>计算机的五大组成部件</strong></span></a></h3><ul><li>Memory</li><li>I/O</li><li>Datapath 数据通路 <strong>执行部件</strong></li><li>Control Unit 控制部件 <strong>控制器</strong>：控制器对执行部件发出信号。</li></ul><hr><h4 id="数据通路datapath的基本结构" tabindex="-1"><a class="header-anchor" href="#数据通路datapath的基本结构"><span><strong>数据通路Datapath的基本结构</strong></span></a></h4><p>数据通路是由<strong>操作元件和存储元件</strong>通过<strong>总线</strong>方式或<strong>分散</strong>方式连接而成的进行<em><strong>数据存储、处理、传送</strong></em>的路径</p><p><strong>操作元件</strong>：（是组合逻辑电路）</p><p><strong>存储元件</strong>：（时序逻辑电路）</p><p>setup时间：在时钟边沿到来<strong>之前</strong>，输入端保持不变的时间；</p><p>hold时间：在时钟边沿<strong>之后</strong>，输入端必须保持不变的时间；</p><p>clk-to-q锁存延迟：从时钟边沿到输出端稳定的时间；</p><h4 id="数据通路和时序控制" tabindex="-1"><a class="header-anchor" href="#数据通路和时序控制"><span>数据通路和时序控制</span></a></h4><p>指令周期 : CPU执行一条指令需要的时间。</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250421114837747.png" alt="image-20250421114837747" tabindex="0" loading="lazy"><figcaption>image-20250421114837747</figcaption></figure><p>指令周期：<strong>Cycle Time = Latch Prop + Longest Delay Path + Setup + Clock Skew</strong></p><p>为了满足数据通路的要求，要能够盲注下面这个约束关系：<br> $$<br> holdTime&lt; ClkToQ+shortestDelay<br> $$<br> 即，<strong>在下一个信号到来前，能够hold不变，防止输出异常</strong></p><hr><h3 id="计算机性能" tabindex="-1"><a class="header-anchor" href="#计算机性能"><span>计算机性能</span></a></h3><p>衡量CPU性能的是<strong>用户CPU时间</strong>，执行用户的作业所需的时间，不考虑IO等</p><p>CPU的执行时间：</p><p>T= CPU的时钟周期数*时钟周期/程序= 指令条数/程序 *CPI *时钟周期</p><blockquote><p>一个程序的时钟周期数x时钟周期</p></blockquote><p><strong>CPI</strong>： Cycle Per Instruction，每一条指令需要多少个时钟周期</p><p>CPI是一个确定值--和CPU的设计,指令类型有关。</p><p>某个程序的CPU时间为：<br> $$<br> CPU \space Time= \sum_{i=1}^n {CPI_i * C_i}<br> $$<br> Ci为第i类指令，CPI_i 是这种指令的CPI。 再除以指令总数，即可得到程序的平均CPI.</p><hr><p>为什么 ISA也会影响CPI？ 因为RISC-V没有提供像乘法和除法的指令，每个指令的时钟周期都比较短。</p><p>时钟频率翻倍但是</p><p>基准测试程序：专门用于测试性能测试的程序，使得计算机有个公共的比较方法。</p><p><strong>计算机性能由三个关键因素决定：指令数目，CPI，时钟周期</strong></p><ul><li>指令数目由编译器和ISA决定</li><li>CPI由ISA和CPU决定</li><li>时钟周期由CPU的实现来决定</li></ul><p>CPU时间 = 指令数目 *</p><h2 id="单周期的cpu设计" tabindex="-1"><a class="header-anchor" href="#单周期的cpu设计"><span>单周期的CPU设计</span></a></h2><p><strong>单总线数据通路</strong></p><p>这一部分没有听懂，请自行看ppt。</p><p>时钟周期的宽度：以read、write为准（因为要以最长的为准）</p><p><strong>常见的指令！！！</strong></p><table><thead><tr><th>指令</th><th>功能 这里用的不是RTL！是我自己写的</th><th>说明</th></tr></thead><tbody><tr><td>add rd rs1 rs2</td><td>R[rd]=R[rs1]+R[rs2]</td><td></td></tr><tr><td>slt rd rs1 rs2</td><td>rd = 1 if R[rs1]&lt;R[rs2] else 0</td><td>使用signed比较</td></tr><tr><td>sltu rd rs1 rs2</td><td>rd= 1 if R[rs1]&lt;R[rs2] else 0</td><td>使用unsigned比较</td></tr><tr><td>ori rd rs1 imm12</td><td>R[rd]= rs1 | SEXT[imm12]</td><td>ori：or immedia</td></tr><tr><td>lui rd imm20</td><td>R[rd]= SEXT[imm20]</td><td>U型imm</td></tr><tr><td>lw rd rs1 imm12</td><td>R[rd] = M[rs1+SEXT[imm12]]</td><td></td></tr><tr><td>sw rs1 rs2 imm12</td><td>M[R[rs1]+SEXT[imm12]] =</td><td></td></tr><tr><td>beq rs1 rs2 imm12</td><td>PC=PC+SEXT[imm12*2] if rs1= rs2</td><td>注意imm12要乘以2</td></tr><tr><td>jal rd im20</td><td></td><td></td></tr></tbody></table><p><strong>存储数据的指定</strong>：</p><p>寄存器编号只需5位</p><p>32bit machine的总线只有32位，理论上最大访问的内存为2的32次方，也就是4GB；</p><hr><h3 id="单流水线cpu的设计" tabindex="-1"><a class="header-anchor" href="#单流水线cpu的设计"><span><strong>单流水线CPU的设计</strong></span></a></h3><p>除R-型外，其他5类都带有立即数 ——立即数扩展器</p><p>核心运算类功能的实现 ——ALU<br> 根据PC取指令和PC+4 ——取指令部件<br> 指令的RTL最终实现 ——完整数据通路</p><h4 id="立即数扩展器" tabindex="-1"><a class="header-anchor" href="#立即数扩展器"><span>立即数扩展器</span></a></h4><p>为什么需要一个立即数扩展器？ 因为RISCV的指令二进制表示中，imm的排列很混乱，而且不同的指令的imm位数和排列往往不同，因此需要立即数扩展器</p><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250425114704950.png" alt="image-20250425114704950" style="zoom:50%;"><p>除了R型指令不需要寄存器，其他都有寄存器。因此需要一个5选1的选择器。ExtOP为3位，具体如何得到ExtOP呢？<strong>需要根据编码Instr得到</strong></p><h4 id="alu-算数逻辑部件的设计" tabindex="-1"><a class="header-anchor" href="#alu-算数逻辑部件的设计"><span>ALU 算数逻辑部件的设计</span></a></h4><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250425115156719.png" alt="image-20250425115156719" style="zoom:50%;"><p>实现的功能：</p><ul><li><p>add or slt sltu srcB,判0</p><p>即实现了加法，或运算，比较，将B直接输出，判断是否为0；</p></li></ul><p>因为上述的9条指令需要这些运算，比如lw指令，需要加法（lw rd rs1 imm12: R[rd] &lt;--- M[R[]]</p><h4 id="取指令部件-instruction-fetch-unit" tabindex="-1"><a class="header-anchor" href="#取指令部件-instruction-fetch-unit"><span>取指令部件 Instruction Fetch Unit</span></a></h4><p>每一次运行指令都有一步<strong>更新PC</strong>的步骤，需要依靠取指令部件；</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250427103915530.png" alt="image-20250427103915530" tabindex="0" loading="lazy"><figcaption>image-20250427103915530</figcaption></figure><h4 id="r型指令的数据通路" tabindex="-1"><a class="header-anchor" href="#r型指令的数据通路"><span>R型指令的数据通路</span></a></h4><p>R型指令：</p><ul><li>add rd rs1 rs2:</li><li>slt rd rs1 rs2;</li><li>sltu rd rs1 rs2;</li></ul><p>R型指令无需imm，直接从寄存器组中读取、写入数据即可：</p><p><strong>写使能端信号不能乱取！！！防止出现错误</strong></p><p>R型指令中，RegWr（<strong>Reg</strong>ister <strong>Wr</strong>ite）为1；</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250427104315618.png" alt="image-20250427104315618" tabindex="0" loading="lazy"><figcaption>image-20250427104315618</figcaption></figure><h4 id="i型指令的型号通路-ori" tabindex="-1"><a class="header-anchor" href="#i型指令的型号通路-ori"><span>I型指令的型号通路（ori)</span></a></h4><p>因为除了R型指令，其他的指令都有imm，rs只有一个，因此需要ALU的输入端需要一个多路选择器，以<strong>ALUBSrc</strong>为控制信号。</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250427104604542.png" alt="image-20250427104604542" tabindex="0" loading="lazy"><figcaption>image-20250427104604542</figcaption></figure><h4 id="u型指令的信号通路" tabindex="-1"><a class="header-anchor" href="#u型指令的信号通路"><span>U型指令的信号通路</span></a></h4><p>U型指令只有一个lui</p><ul><li>lui rd imm20</li></ul><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250427110900124.png" alt="image-20250427110900124" tabindex="0" loading="lazy"><figcaption>image-20250427110900124</figcaption></figure><h4 id="load-store指令的信号通路" tabindex="-1"><a class="header-anchor" href="#load-store指令的信号通路"><span>Load&amp;Store指令的信号通路</span></a></h4><p>指令详情：</p><ul><li>load rd rs1 imm12; R[rd] = M[R[rs1]+SEXT[imm12]] 。 <strong>注意：这里的imm不需要乘以2，因为数据是按字节寻址的</strong></li><li>store rs1 rs2 imm12; M[R[rs1]+SEXT[imm12]]&lt;--R[rs2]。</li></ul><p>Load和Store指令涉及到了存储器的访问，这里以理想存储器为例：</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250427110804853.png" alt="image-20250427110804853" tabindex="0" loading="lazy"><figcaption>image-20250427110804853</figcaption></figure><blockquote><p>MemtoReg: 即 Memory To Register</p></blockquote><p>注意：B和J型指令的imm通常需要左移一位，这是因为在设计的时候省略了1位，或者说默认最后一位为0（处于对齐指令的目的）；在RISCV规范中，给出了相关的内容，可以参考<a href="https://zhuanlan.zhihu.com/p/377200438" target="_blank" rel="noopener noreferrer">RV32I控制转移指令的偏移量计算问题 - 知乎</a></p><h4 id="b型指令的数据通路" tabindex="-1"><a class="header-anchor" href="#b型指令的数据通路"><span>B型指令的数据通路</span></a></h4><p>指令为：</p><ul><li>beq rs1 rs2 imm12; if(R[rs1]=R[rs2]) PC&lt;-- PC+(SEXT(imm12)&lt;&lt;1) else PC&lt;-- PC+4;</li></ul><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250427112357474.png" alt="image-20250427112357474" tabindex="0" loading="lazy"><figcaption>image-20250427112357474</figcaption></figure><p>其中下地址逻辑为：（只有当ALU计算结果为0，并且是Branch指令，才会将imm和PC相加，否则PC=PC+4）</p><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250427112744627.png" alt="image-20250427112744627" style="zoom:50%;"><h4 id="j型指令" tabindex="-1"><a class="header-anchor" href="#j型指令"><span>J型指令</span></a></h4><p>J型指令：</p><ul><li>jal rd imm20; R[rd]&lt;- PC+4, PC&lt;- PC+SEXT(imm20&lt;&lt;1);</li></ul><p>J型指令除了需要跳转，还需要将下一条指令存入寄存器（实现call的操作）</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250427113923927.png" alt="image-20250427113923927" tabindex="0" loading="lazy"><figcaption>image-20250427113923927</figcaption></figure><hr><p><strong>指令的执行结果总是在新的时钟周期到来之前，才会将其保存在寄存器、PC、存储器中</strong></p><p>一个时钟周期的时间为：clk-to-q+longest delay +setup+ 时钟偏移，可以看出，时钟周期应该根据最长的delay来决定。</p><hr><blockquote><p>考试的时候以 短周期和流水线的数据通路图、控制器，很清楚地知道每一个控制信号，每一条线的内容，指令必须看得到，不一定会写汇编代码。</p></blockquote><h3 id="控制器的设计" tabindex="-1"><a class="header-anchor" href="#控制器的设计"><span>控制器的设计</span></a></h3><p>前面提过，CPU的核心是数据通路（执行部件）和控制器（控制部件），前面已经设计好了数据通路，但是数据通路中的很多信号，比如ALUctr需要控制器的作用。</p><h4 id="控制信号的取值分析" tabindex="-1"><a class="header-anchor" href="#控制信号的取值分析"><span>控制信号的取值分析</span></a></h4><ol><li><p><strong>所有指令执行的共同操作</strong></p><p>每一条指令运行的过程都是：Clk信号到来，经过一个Clk-To-Q（锁存延时）之后，PC被写入<strong>指令存储器</strong>，经过取数时间，指令被取出，送入控制器，<strong>在控制器中译码，并且发出控制信号</strong>，之后进入数据通路计算，下一个时钟周期到来，新的数据被写入。</p><blockquote><p>对于R型指令，新的PC很快得到，到那时对于跳转指令，需要等待运算才能得到新的PC值。</p></blockquote></li><li><p><strong>R型指令的执行过程</strong></p><p>Rd,Rs1,Rs2来自取指令单元（指令存储器），各种控制信号来自控制器。（回顾过程：PC寄存器经过clk2q之后MAR得</p><p>R型指令的执行过程可以概括为：Rigister(rs1,rs2) -&gt; busA,busB-&gt;buwW-&gt;Rigister(rd)</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428101709013.png" alt="image-20250428101709013" tabindex="0" loading="lazy"><figcaption>image-20250428101709013</figcaption></figure><blockquote><p>留心这些控制信号的取值和含义，比如MemWr应该一定为0，MemtoReg也是为0</p></blockquote><p>R型指令的时间分析：</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428102812207.png" alt="image-20250428102812207" tabindex="0" loading="lazy"><figcaption>image-20250428102812207</figcaption></figure></li><li><p>I型指令的执行过程</p><p>Rigister(rs1)-&gt;busA,扩展器(imm12)-&gt; ALU-&gt; Rigister(rd)</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428103132649.png" alt="image-20250428103132649" tabindex="0" loading="lazy"><figcaption>image-20250428103132649</figcaption></figure></li><li><p>U型指令的执行过程</p></li><li><p>Load指令</p></li><li><p>Store指令</p></li><li><p>B型指令</p></li><li><p>J型指令</p></li><li><p>最终指令和真值表的取值</p><p><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428103320124.png" alt="image-20250428103320124" loading="lazy">因此可以通过极小项写出每一个控制信号的 逻辑表达式</p><p>比如：Branch=op&lt;6&gt;&amp;op&lt;5&gt;&amp;<sub>op&lt;4&gt;&amp;</sub>op&lt;3&gt;&amp;~op&lt;2&gt;&amp;op&lt;1&gt;&amp;op&lt;0&gt; (B-type)</p><p>Jump=op&lt;6&gt;&amp;op&lt;5&gt;&amp;~op&lt;4&gt;&amp;op&lt;3&gt;&amp;op&lt;2&gt;&amp;op&lt;1&gt;&amp;op&lt;0&gt; (J-type)</p><blockquote><p>这里没有考虑funct3功能码，是因为B-type指令的op都是1100011，具体功能由funct3决定，即，B型指令的op都相同，只要保证op为1100011时Branch信号为1即可；而J-type的指令没有funct3字段；</p></blockquote><p>我们依次分析每一个控制信号的真值表达式，最后链接电路：</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428105102309.png" alt="image-20250428105102309" tabindex="0" loading="lazy"><figcaption>image-20250428105102309</figcaption></figure></li></ol><h4 id="时钟周期的设计" tabindex="-1"><a class="header-anchor" href="#时钟周期的设计"><span>时钟周期的设计</span></a></h4><p>时钟周期应该要满足最慢的指令（load）的要求</p><p>load指令：（load rd rs1 imm12）</p><ul><li>clk2q+取指令时间</li><li>译码时间（控制单元延迟）</li><li>寄存器读数延迟（得到R[rs1]）</li><li>ALU延迟（得到addr=R[rs1]+SEXT[imm12]）</li><li>存储器读数延迟 （读取M[addr]）</li><li>寄存器setup时间</li></ul><hr><p>例子：<a id="q"></a>假设在单周期处理器中，各主要功能单元的操作时间为：</p><p>存储单元：200ps\ ALU和加法器：100ps\ 寄存器堆（读/写）：50ps</p><p>假设MUX、控制单元、PC、扩展器和传输线路都没有延迟，则单周期实现方式（每条指令在一个固定长度的时钟周期内完成）中，CPU执行时间如何计算？</p><p>那么我们可以确定：</p><p>R-type： 取指令200+读rs1、rs2 50+ALU100+写rd 50= 400</p><p>Load Word指令：取指令200+读rs1 50+ ALU100+ 存储器读取 200+ 写入rd 50= 600</p><p>Store Word指令：取指令200 + 读取rs1，rs2 50 +ALU100 + store 200= 550（注意rs1和rs2的读取是并行的）</p><p>Branch： 取指令200+ 读取rs1，rs2, 50 +ALU100 = 350</p><p>Jump： 取指令200+ 存入PC+4 50 + ALU计算跳转位置 100 =350；</p><hr><h2 id="多周期cpu设计" tabindex="-1"><a class="header-anchor" href="#多周期cpu设计"><span>多周期CPU设计</span></a></h2><p>下面以实现一个简单的指令系统为例，讲解多周期CPU的设计</p><blockquote><p>这个指令系统不用记！！！</p></blockquote><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428112505398.png" alt="image-20250428112505398" tabindex="0" loading="lazy"><figcaption>image-20250428112505398</figcaption></figure><p><strong>多周期的数据通路</strong></p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428112702885.png" alt="image-20250428112702885" tabindex="0" loading="lazy"><figcaption>image-20250428112702885</figcaption></figure><h3 id="指令执行的过程" tabindex="-1"><a class="header-anchor" href="#指令执行的过程"><span>指令执行的过程</span></a></h3><blockquote><p>Note: 多周期的CPU的时钟周期取的是任何一条指令、所有阶段中最长的那一个；在下面的各种阶段中，取指令阶段因为涉及到一次存储器访问和一次寄存器保存过程，因此耗时最长（访问寄存器的耗时比较长，可以参考<a href="#q">上面的例题</a></p></blockquote><h4 id="取指令并计算下条指令地址" tabindex="-1"><a class="header-anchor" href="#取指令并计算下条指令地址"><span>取指令并计算下条指令地址</span></a></h4><p>该阶段对应状态记为IFetch。因为采用定长指令字，故PC增量操作可在取指令阶段完成。取指阶段的功能是：将PC内容作为地址访问主存以取出指令，将指令存入指令寄存器IR中，并将PC+4作为下条指令地址送PC。实现上述功能的有效控制信号及其取值如下。</p><ul><li>R[IR]&lt;-M[PC]:PCout=1,MARout=0,MemWr=0,IRWr=1。</li><li>PC&lt;-PC+4:Add1MUX=0,Add2MUX=1,PCWr=1。、</li><li>其他寄存器写使能信号(如MARWr、CCWr、MDRWr、ALUoutWr、RegWr)全部为0。</li></ul><hr><h4 id="译码并取数" tabindex="-1"><a class="header-anchor" href="#译码并取数"><span>译码并取数</span></a></h4><p>将IR中的op段送入控制器，得到控制信号；将Rs,Rt输入到寄存器组的Ra，Rb端；</p><p>同时会进行“投机计算”：计算Load、Store指令中的地址，并且存放在MAR中。</p><h4 id="执行指令" tabindex="-1"><a class="header-anchor" href="#执行指令"><span>执行指令</span></a></h4><p>3)执行指令<br> 控制部件对指令译码后，会和条件码中的标志信息组合生成控制信号，从而使CPU在控制信号的控制下执行指令。针对不同指令的功能，其对应的有效控制信号如下。</p><ol><li><p>R-型指令：R[Rt]-R[Rs]op R[Rt]<br> R-型指令的执行需要两个时钟周期，对应状态分别记为RExec和RFinish。</p><ul><li>RExec状态的功能为：进行ALU运算并将结果存入ALUout和CC寄存器。其有效控制信号及其取值为 BMUX=1,ALUOp=xxx,ALUoutWr=1,CCWr=1,其他寄存器写使能信号全部为0。其中，ALUOp的取值由指令操作码决定，以控制ALU进行不同的运算。</li><li>RFinish状态的功能为：将ALUout的内容存入Rt。其有效控制信号及其取值为：RegMUX=1,RegWr=1,其他寄存器写使能信号全部为0。</li></ul><p>问题：为什么不把这两个阶段给合并？如果两个周期合并，可能来不及把异常结果转去进行异常处理，就可能把错误结果写入寄存器了如果Rfinish之后再进入溢出异常处理状态，则需要保证RegWr修改为0；简而言之：为了异常处理。</p></li><li><p>I-型运算指令：R[Rt]←R[Rs]op EXT[imm16]<br> I-型运算指令的执行需要两个时钟周期，对应状态分别记为IExec和IFinish。</p><ul><li>IExec状态的功能为：进行ALU运算并将结果存入ALUout和CC寄存器。其有效控制信号及其取值为：ExtOp=0或1,BMUX=0,ALUOp=xxx,ALUoutWr=1,CCWr=1,其他寄存器写使能信号全部为0。与R-型指令一样，ALUOp的取值由指令操作码决定，不同的取值控制ALU进行不同的运算。</li><li>IFinish状态的功能为：将ALUout的内容存入Rt。其有效控制信号及其取值为：RegMUX=1,RegWr=1,其他寄存器写使能信号全部为0。经分析可知，IFinish和RFinish两个状态的功能完全一样，因此，可以将两个状态合并成一个状态：RIFinish。</li></ul></li><li><p>Load指令：R[Rt]-M[R[Rs]+SEXT[imm16]]<br> Load指令的执行包含三个子功能，需要三个时钟周期。因为在“译码并取数”阶段已经计算出地址并存入MAR中，因而还需要两个时钟周期，对应状态分别记为lwExec和lwFinish。</p><ul><li>lwExec状态的功能为：读主存内容并保存到MDR。其有效控制信号及其取值为：MARout=1,PCout=0,MemWr=0,MDRMUX=0,MDRWr=1,其他寄存器写使能信号全部为0。</li><li>lwFinish状态的功能为：将MDR内容存入Rt。其有效控制信号及其取值为：RegMUX=0,RegWr=1,其他寄存器写使能信号全部为0。</li></ul></li><li><p>Store指令：M[R[Rs]+SEXT[imm16]]-R[Rt]</p><p>Store指令的执行包含三个子功能，需要至少三个时钟周期。因为在“译码并取数”阶段已经计算出地址并存入MAR中，因而只需要两个时钟周期，对应状态分别记为swExec和swFinish。</p><ul><li>swExec状态的功能为：将Rt存入MDR并直送总线。其有效控制信号及其取值为：MDRMUX=1,MDRWr=1,MARout=1,PCout=0,MemWr-0,其他寄存器写使能信号全部为0。</li><li>swFinish状态的功能为：将MDR送入总线的数据写入主存。其有效控制信号及其取值为：MARout=1,PCout=0,MemWr=1,其他寄存器写使能信号全部为0。</li></ul></li><li><p>Jump指令：PC+PC+SEXT[imm16]<br> Jump指令的功能为：进行转移目标地址计算并送PC。它只需要一个时钟周期，对应状态记为JFinish。</p><ul><li>其有效控制信号及其取值为：ExtOp=1,Add1MUX=0,Add2MUX=0,PCWr=1,其他寄存器写使能信号全部为0。</li></ul><p>根据上述对每条指令执行过程的分析，得到一个状态转换图。图8.32是一个支持R-型指令、I-型运算指令、Load/Store指令和Jump指令执行的状态转换示意图。</p><p>图中每个状态用一个状态编号和状态名标识，例如，0:IFetch表示第0状态，执行取指令(IFetch)操作，圆圈中示意性地给出了该状态下部分控制信号的取值，其中，有取值为0和取值为1的两种有效控制信号，以及多值有效控制信号ALUOp,ALUOp=xxx表示根据操作码OP译码得到的一个ALU操作控制信号取值为xxx。此外，图中的x表示取值为任意的无效控制信号。</p><p>在图8.31所示的多周期数据通路中，每条指令的执行过程就是图8.32所示的状态转换过程。每来一个时钟，进入下一个状态。从图8.32可看出，R-型指令、I-型运算指令、Load和Store指令的CPI都为4,跳转指令Jump的CPI为3。如果不在译码/取数阶段“投机”计算访存地址，则Load和Store指令的CPI为5。</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250428115548563.png" alt="image-20250428115548563" tabindex="0" loading="lazy"><figcaption>image-20250428115548563</figcaption></figure></li></ol><hr><blockquote><p>五一假期结束，现在看不懂自己的笔记了</p></blockquote><p>时钟周期的= clock-to-q+setup+longest-delay</p><p>注意无论是那一条指令，都有两个步骤是相同的，即IFetch和RFetch/ID，其中IFetch进行取指令，并且计算PC+4；RFetch/ID有‘投机计算’</p><p>状态1之后，按照指令的译码进入不同的指令。</p><p>除了Jump指令是3个周期之外，所有的指令都是4个周期，即除了Jump的CPI为3其他都是为4</p><blockquote><p>如果没有投机计算，那么lw和sw的CPI为5</p></blockquote><h3 id="pla控制器的设计" tabindex="-1"><a class="header-anchor" href="#pla控制器的设计"><span>PLA控制器的设计</span></a></h3><p>PLA控制器又称为组合逻辑控制器，或者硬连线控制器。</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509104343151.png" alt="image-20250509104343151" tabindex="0" loading="lazy"><figcaption>image-20250509104343151</figcaption></figure><p><strong>下一状态是当前状态和操作码的函数</strong></p><p>我们可以画出一个状态转换表来实现PLA电路，</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509104713007.png" alt="image-20250509104713007" tabindex="0" loading="lazy"><figcaption>image-20250509104713007</figcaption></figure><p>硬连线方式可以自行看ppt了解，因为不是重点，故不在这里展示。</p><p>特点是：1. 速度快 2. 硬件实现复杂、灵活性差。</p><h3 id="微程序控制器设计" tabindex="-1"><a class="header-anchor" href="#微程序控制器设计"><span>微程序控制器设计</span></a></h3><blockquote><p>这是一个很有趣的思想，尽管在这里用不上。</p></blockquote><p>基本思想：用微程序来描述机器指令，每一个微程序都有多个微指令，微指令有多个微命令。</p><p>每一条微指令和一个状态对应（这里的状态指的是上述的状态转换图的圈圈图）</p><p>所有的微程序只存出在制度存储器中，称为控制存储器，Control Storage 简称控存CS。</p><hr><h4 id="执行指令-1" tabindex="-1"><a class="header-anchor" href="#执行指令-1"><span>执行指令</span></a></h4><ul><li>从CS中取出微程序</li><li>执行微程序也就是执行其中的微指令</li><li>对微指令译码就是产生对应的微命令-控制信号</li><li>按照微命令来执行程序</li></ul><p>可以了解一下微程序控制器的基本结构：</p><p>其中$\mu$ 开头的代表<strong>微</strong></p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509110118838.png" alt="image-20250509110118838" tabindex="0" loading="lazy"><figcaption>image-20250509110118838</figcaption></figure><h4 id="微指令的设计" tabindex="-1"><a class="header-anchor" href="#微指令的设计"><span>微指令的设计</span></a></h4><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509113020592.png" alt="image-20250509113020592" tabindex="0" loading="lazy"><figcaption>image-20250509113020592</figcaption></figure><blockquote><p>在这里我就想吐槽了： 也没有铺垫，也没说为什么要在这里将异常处理机制</p></blockquote><h3 id="异常处理机制" tabindex="-1"><a class="header-anchor" href="#异常处理机制"><span>异常处理机制</span></a></h3><h4 id="带异常处理机制的数据通路设计" tabindex="-1"><a class="header-anchor" href="#带异常处理机制的数据通路设计"><span>带异常处理机制的数据通路设计</span></a></h4><p>添加，两个寄存器EPC和Cause，前者存储断点，后者存储异常状态；</p><p>同样的，需要添加这两个寄存器的写使能信号，</p><ul><li>EPCWr：在保存断点的时候有效，存入断点的PC</li><li>CauseWr： 发现异常的的时候有效，将异常类型存入Cause寄存器</li></ul><p>示意图：</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509114300857.png" alt="image-20250509114300857" tabindex="0" loading="lazy"><figcaption>image-20250509114300857</figcaption></figure><p>重点关注其中有关Casue和EPC的部分，是在原先的数据通路下添加的。</p><h4 id="带异常处理机制的控制器设计" tabindex="-1"><a class="header-anchor" href="#带异常处理机制的控制器设计"><span>带异常处理机制的控制器设计</span></a></h4><p>前面数据通路使用到的新的寄存器写使能端信号需要由控制器生成，并且需要设计两个异常状态。</p><p>加入异常和中断事件后的状态转换图：</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509114755501.png" alt="image-20250509114755501" tabindex="0" loading="lazy"><figcaption>image-20250509114755501</figcaption></figure><h3 id="多周期和时钟周期的cpu比较" tabindex="-1"><a class="header-anchor" href="#多周期和时钟周期的cpu比较"><span>多周期和时钟周期的CPU比较</span></a></h3><p><strong>多周期的时钟周期是所有阶段的最长值</strong> (就是上面的那个图中所有最长的周期！)</p><p>单周期的时钟周期是所有指令中的最大值。（一般是lord指令）</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509114657162.png" alt="image-20250509114657162" tabindex="0" loading="lazy"><figcaption>image-20250509114657162</figcaption></figure><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509114650257.png" alt="image-20250509114650257" tabindex="0" loading="lazy"><figcaption>image-20250509114650257</figcaption></figure><hr><h1 id="_4-流水线cpu的设计" tabindex="-1"><a class="header-anchor" href="#_4-流水线cpu的设计"><span>4. 流水线CPU的设计</span></a></h1><p>前面提到，多周期CPU并不能很明显地提升性能，下面介绍流水线CPU。</p><h2 id="核心思想" tabindex="-1"><a class="header-anchor" href="#核心思想"><span>核心思想</span></a></h2><p>流水线CPU的核心思想是，将指令分成不同的阶段，在前一个指令的某一个阶段完成之后，紧接着开始执行下一个指令的这一个阶段。如图，以load指令为例。</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509115710725.png" alt="image-20250509115710725" tabindex="0" loading="lazy"><figcaption>image-20250509115710725</figcaption></figure><blockquote><p>必须保证不同阶段不会冲突，即不会用到相同的部件，比如在夏木木寄存器堆的读和写是分开的，可以看成两个独立的部件</p><p>结构冒险：同一个时钟周期内，多个指令都使用了同一个部件。</p></blockquote><blockquote><p>流水线每一个阶段的时间是相同的（都是所有阶段的最大值），应该很好理解，因为是并行执行不同指令的不同阶段，所以必须满足最大的时间要求。</p></blockquote><h2 id="与其他cpu比较" tabindex="-1"><a class="header-anchor" href="#与其他cpu比较"><span>与其他CPU比较</span></a></h2><p>性能比较：</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250509115926577.png" alt="image-20250509115926577" tabindex="0" loading="lazy"><figcaption>image-20250509115926577</figcaption></figure><p><strong>流水线能够大大提高指令的吞吐率</strong>(单位时间内执行的指令条数)</p><blockquote><p>在理想状态下（忽略流水线启动的初始4个周期），流水线一直都是五个部件，每一个周期都有指令执行完成，也有指令开始执行；</p><p>因此流水线CPU的理想下的CPI为1，虽然每一条指令都需要5个周期，但是同时可以执行5个指令，因此CPI为1。</p><p>回顾： 1. 单周期CPU的CPI为1，以最长的指令load来取周期宽度。 2. 流水线的CPU的CPI为1，周期宽度为5个阶段最长的那个（实际执行的时候每一个阶段都会占用一个周期的时间） 3.多周期的CPI需要知道不同指令的比例，jump指令占用3个周期，其他的指令占用四个周期，需要知道比例进行计算。多周期的时钟周期宽度为最长的那个。</p></blockquote><hr><h2 id="指令执行分析" tabindex="-1"><a class="header-anchor" href="#指令执行分析"><span>指令执行分析</span></a></h2><p>流水线CPU将指令分成以下五个阶段：</p><p>Ifetch,Reg/Dec (取数和译码),Exec(执行), Mem（读存储器）, Wr（写寄存器）</p><p>先以load指令为例：</p><blockquote><p>load rs1 rs2 imm12 RTL功能为 R[rs1]&lt;-M[R[rs2]+STEX(imm12)]</p></blockquote><ul><li>Ifetch： 取指令、计算PC+4，需要用到指令存储器、Adder</li><li>Reg/Dec : 取数并且译码，需要用到寄存器、指令译码器</li><li>Exec：执行，ALU、扩展器</li><li>Mem： 数据存储器</li><li>Wr： 写使能端</li></ul><blockquote><p>流水线CPU设计使得每一条指令的执行的时候占用的资源都是不一样的。</p><p>同一个功能部件</p><p>同时被多条指令使用的现象叫做<strong>结构冒险</strong></p><p>为了流水线能够正常地工作，我们规定：</p><ul><li>每一个功能部件在一条指令中 只能使用一次</li><li>每一个部件使用的时候必须在同一个阶段</li></ul><p>我们需要设计每一种类型的指令，使得所有的指令都能符合这个规定</p></blockquote><hr><h3 id="r-type" tabindex="-1"><a class="header-anchor" href="#r-type"><span>R-Type</span></a></h3><p>R型指令因为不需要进行</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250516105219861.png" alt="image-20250516105219861" tabindex="0" loading="lazy"><figcaption>image-20250516105219861</figcaption></figure><p>Ifetch: 取指令</p><p>Reg/Dec：取操作数rs1 rs2，指令译码</p><p>Exec：进行运算，使用ALu</p><p>Wr：将结果写入目的寄存器</p><hr><h3 id="store" tabindex="-1"><a class="header-anchor" href="#store"><span>Store</span></a></h3><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250516110435256.png" alt="image-20250516110435256" tabindex="0" loading="lazy"><figcaption>image-20250516110435256</figcaption></figure><p>Ifetch：取指令并计算PC+4 （写入PC）</p><p>Reg/Dec： 从寄存器（rs1）取数，同时指令在译码器进行译码</p><p>Exec：12位立即数（imm12）符号扩展后与寄存器值（ rs1 ）相加，计算主存地址Mem：将寄存器（rs2）读出的数据写到主存</p><hr><h3 id="i-type" tabindex="-1"><a class="header-anchor" href="#i-type"><span>I-Type</span></a></h3><hr><h3 id="beq" tabindex="-1"><a class="header-anchor" href="#beq"><span>Beq</span></a></h3><p>与其他指令不同的区别是，Beq中间的Exec阶段需要用到ALU和adder，因此必须单独加上一个adder，防止和其他指令冲突</p><blockquote><p>每一个功能部件只能在同一阶段使用、每一个周期只能用一次。即上述的adder只能在第三周期使用。</p></blockquote><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250516105727514.png" alt="image-20250516105727514" tabindex="0" loading="lazy"><figcaption>image-20250516105727514</figcaption></figure><p>Ifetch: 取指令并计算PC+4 （写入PC，但后续可能需要修改PC）</p><p>Reg/Dec:从寄存器（rs1，rs2）取数，同时指令在译码器进行译码</p><p>Exec: 执行阶段ALU中比较两个寄存器（rs1，rs2）的大小（做减法）Adder中计算转移地址（PC+SEXT（imm12）&lt;&lt;1）</p><p>Mem: 如果比较相等, 则：转移目标地址写到PC</p><blockquote><p>这里转移目标地址的方法可以参考单周期的相关指令，通过控制信号生成下一个PC地址</p></blockquote><h3 id="j-type" tabindex="-1"><a class="header-anchor" href="#j-type"><span>J-Type</span></a></h3><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250516110036021.png" alt="image-20250516110036021" tabindex="0" loading="lazy"><figcaption>image-20250516110036021</figcaption></figure><p><code>Ifetch</code>: 取指令并计算PC+4 （写入PC ，但后续肯定需要修改PC ）</p><p><code>Reg/Dec:</code>从寄存器取数，同时指令在译码器进行译码</p><p><code>Exec</code>: 执行阶段ALU中计算PC+4（准备写入rd）Adder中计算转移地址（PC+SEXT（imm20）&lt;&lt;1）</p><p><code>Mem</code>:把转移地址写入PC</p><blockquote><p>PC可以修改多次，因为更新PC的时候前一个PC已经没有用了，不会出现冲突。</p></blockquote><p><code>Wr</code>: 把ALU运算结果（PC+4）写入rd.</p><hr><h2 id="数据通路设计" tabindex="-1"><a class="header-anchor" href="#数据通路设计"><span>数据通路设计</span></a></h2><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250516111552870.png" alt="image-20250516111552870" tabindex="0" loading="lazy"><figcaption>image-20250516111552870</figcaption></figure><p>和单周期的区别在与中间的<code>流水段寄存器</code>，用于保存每一个周期的执行结果，属于内部寄存器，可以理解为，每一个寄存器里面存储的都是某一条指令的当前状态（寄存器和它右边的部分属于当前状态）。</p><blockquote><p>&quot;The pipelined datapath consists of combination logic blocks separated by pipeline registers. If you get rid of all these registers (not the PC), this pipelined datapath is reduced to the single-cycle datapath.&quot;</p></blockquote><blockquote><p>ppt中还提到了其他的一个细节：下一个clock tick来临之后需要一个clock-to-Q才能进行下一阶段（或者说写入下一个阶段）</p></blockquote><h3 id="iunit设计" tabindex="-1"><a class="header-anchor" href="#iunit设计"><span>IUnit设计</span></a></h3><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250516114408758.png" alt="image-20250516114408758" tabindex="0" loading="lazy"><figcaption>image-20250516114408758</figcaption></figure><p>在IF/ID寄存器中存储有PC和指令</p><p>IF段的功能PC+4、取指令</p><h3 id="reg-dec" tabindex="-1"><a class="header-anchor" href="#reg-dec"><span>Reg/Dec</span></a></h3><p>在ID/EX寄存器中，存储<code>R[Rs1], R[Rs2], Rd, Imm, PC</code></p><h3 id="exec-unit的设计" tabindex="-1"><a class="header-anchor" href="#exec-unit的设计"><span>Exec Unit的设计</span></a></h3><blockquote><p>详细内容请见ppt，不同的指令需要的信号来自不同的地方</p><p>可以留心的是，这里使用了Adder和ALu，进行并行计算，因为前面有一个步骤在这里需要同时进行两个计算（如果都用ALU算的话，显然会冲突）。</p></blockquote><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250516115523660.png" alt="image-20250516115523660" tabindex="0" loading="lazy"><figcaption>image-20250516115523660</figcaption></figure><p>在EX/M寄存器中存储了，跳转地址、Zero、ALU运算结果、busB、rd</p><hr><h3 id="m段" tabindex="-1"><a class="header-anchor" href="#m段"><span>M段</span></a></h3><h3 id="wb写回段" tabindex="-1"><a class="header-anchor" href="#wb写回段"><span>WB写回段</span></a></h3><blockquote><ol><li>M段有PC写回的操作，出现数据回流，可能出现结构冒险</li><li>WB段可能有写入寄存器的操作，也可能会出现结构冒险的问题</li></ol></blockquote><hr><h2 id="流水线中的control-signals" tabindex="-1"><a class="header-anchor" href="#流水线中的control-signals"><span>流水线中的Control Signals</span></a></h2><ol><li>PC不需要写使能</li><li>流水段寄存器不需要写使能信号</li></ol><p>在流水线中的控制信号：</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250523104536906.png" alt="image-20250523104536906" tabindex="0" loading="lazy"><figcaption>image-20250523104536906</figcaption></figure><ol><li>每一个时钟周期到来，五个流水段寄存器都会进行更新，所有的控制信号在ID阶段<strong>一次性生成</strong>，main control的设计和单周期的控制器设计原理一模一样。</li><li>任何一条指令在执行的过程中，其信号是不变的（在ID阶段一次性生成，之后不需要的信号不再保存）</li></ol><h2 id="流水线举例" tabindex="-1"><a class="header-anchor" href="#流水线举例"><span>流水线举例</span></a></h2><p>最开始的时候，将流水段寄存器都初始化为0，保证了不会出现错误的写入等等。</p><p>以下面的这个流水线为例</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250523105300126.png" alt="image-20250523105300126" tabindex="0" loading="lazy"><figcaption>image-20250523105300126</figcaption></figure><p>分析指令的运行结果：</p><ol><li>第一周期</li><li>第二周期</li><li>第三周期</li><li>第四周期</li><li>第五周期</li><li>第六周期</li><li>第七周期</li></ol><p>注意：</p><ol><li>只有在B、J型指令在M阶段的时候才会将新的PC更新为Target，此后下一个周期新出现的指令就是target对应的指令。也就是和target指令之间间隔了3个指令。（取错了3个指令，称之为<code>控制冒险</code>）</li><li>load指令尽管在第一周期就被取出，但是数据在第五周期才写入，在第六周期才能使用，期间可能会错误访问这个数据得到的不是目的结果，称为<code>数据冒险</code></li></ol><h3 id="单周期vs流水线计算机的性能比较" tabindex="-1"><a class="header-anchor" href="#单周期vs流水线计算机的性能比较"><span>单周期vs流水线计算机的性能比较</span></a></h3><p><strong>流水线除了要考虑每一个阶段的最多时间，但是还要考虑流水段寄存器的延迟，具体看是不是</strong></p><h2 id="流水线的冒险和处理" tabindex="-1"><a class="header-anchor" href="#流水线的冒险和处理"><span>流水线的冒险和处理</span></a></h2><blockquote><p>这里是本书最后一个知识点，最后一个高级CPU不会涉及</p></blockquote><p>hazard：流水线无法正确执行后续指令，或者执行了不该执行的指令。</p><p>冒险有：</p><ol><li>结构冒险：同一部件在同时被多个指令所使用</li><li>数据冒险：后面的指令使用用到了前面还没有生成的数据</li><li>控制冒险：在跳转或者处理异常的步骤中，后续指令仍然被错误地取出</li></ol><h3 id="结构冒险的解决" tabindex="-1"><a class="header-anchor" href="#结构冒险的解决"><span>结构冒险的解决</span></a></h3><p><strong>确保每一个指令只会在特定的阶段被使用</strong></p><h3 id="数据冒险的冒险" tabindex="-1"><a class="header-anchor" href="#数据冒险的冒险"><span>数据冒险的冒险</span></a></h3><p>给定下面的一串指令序列</p><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250523113752599.png" alt="image-20250523113752599" style="zoom:25%;"><p>由于add指令需要在第五个周期才能写入新的数据，此时xor指令在IF阶段，到了第六周期的时候，xor指令处于ID阶段，从寄存器堆中取数计算。</p><hr><h4 id="解决方法一-硬件阻塞stall" tabindex="-1"><a class="header-anchor" href="#解决方法一-硬件阻塞stall"><span>解决方法一：硬件阻塞stall</span></a></h4><p>硬件上强制要求阻塞，效率低下</p><figure><img src="https://yamapicgo.oss-cn-nanjing.aliyuncs.com/picgoImage/image-20250523114516205.png" alt="image-20250523114516205" tabindex="0" loading="lazy"><figcaption>image-20250523114516205</figcaption></figure><h4 id="解决方法二-软件上插入无关指令" tabindex="-1"><a class="header-anchor" href="#解决方法二-软件上插入无关指令"><span>解决方法二：软件上插入无关指令</span></a></h4><p>在编译器中插入空指令NOP，在会出现数据冲突的时候插入空指令。编译时间增加，速度也不是很快。</p><h4 id="解决方案三-同一周期内寄存器先写后读" tabindex="-1"><a class="header-anchor" href="#解决方案三-同一周期内寄存器先写后读"><span>解决方案三：同一周期内寄存器先写后读</span></a></h4><p>方案三需要和1或者2合作，改为阻塞两个周期，因为要求先写后读，这样使得ID段指令读到的值是当前M段指令写入的值。</p><h4 id="解决方案四-转发" tabindex="-1"><a class="header-anchor" href="#解决方案四-转发"><span>解决方案四：转发</span></a></h4><p>将ALU的A，B端增加mux，允许从其他的流水段寄存器（第五阶段<code>WB</code>在写的时候已经有数据了，可以将这个数据送到前面去）进行读取数据，进行运算。</p></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/yama-lei/yama-lei.github.io/edit/main/src/posts/NJUCS/数字逻辑与计算机组成/chapter8CPU.md" aria-label="在 GitHub 上编辑此页" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><span class="vp-meta-info" data-allow-mismatch="text">2025/5/24 11:50:20</span></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 1908777046@qq.com">yama-lei</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/posts/NJUCS/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/chapter7%E6%8C%87%E4%BB%A4%E8%AE%A1%E7%AE%97%E9%9B%86.html" aria-label="Chapter7 | 指令系统"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->Chapter7 | 指令系统</div></a><a class="route-link auto-link next" href="/posts/NJUCS/%E6%95%B0%E5%AD%97%E9%80%BB%E8%BE%91%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/FPGA%E8%AE%BE%E8%AE%A1%E5%92%8C%E7%A1%AC%E4%BB%B6%E6%8F%8F%E8%BF%B0%E8%AF%AD%E8%A8%80.html" aria-label="FPGA设计和硬件描述语言"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">FPGA设计和硬件描述语言<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><!----><div class="vp-copyright">Copyright © 2025 yama-lei </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-DYMeyz6b.js" defer></script>
  </body>
</html>
